<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.nwm.common">
	<!--
		1: all, 
		2: test server, 
		3: staging server, 
		4: Test and staging server, 
		5: only solar domain, 
		6: only building domain, 
		7: solar and building 
	-->
	<sql id="siteByDomainCondition">
		<choose>
			<when test="domain == 'test.nextwavemonitoring.com'">
				AND s.site_domain_type IN(1,2,4)
			</when>
			
			<when test="domain == 'staging.nextwavemonitoring.com' || domain =='demo.nextwavemonitoring.com'">
				AND s.site_domain_type IN(1,3,4)
			</when>
			
			<when test="domain == 'nextwavemonitoring.com'">
				AND s.site_domain_type IN(1,5,7)
			</when>
			
			<when test="domain == 'buildings.nextwavemonitoring.com'">
				AND s.site_domain_type IN(1,6,7)
			</when>
			
			<when test="domain == 'demo.nextwavemonitoring.com'">
				AND s.site_domain_type IN(1,4,7)
			</when>
			
			<otherwise>
				AND s.site_domain_type IN(1)
			</otherwise>
		</choose>
	</sql>
	
	<sql id="deviceByDomainCondition">
		<choose> 
       		<when test="domain == 'test.nextwavemonitoring.com'">
                AND d.show_on_domain IN(1,2,4)
            </when>
             
            <when test="domain == 'staging.nextwavemonitoring.com' || domain =='demo.nextwavemonitoring.com'">
                AND d.show_on_domain IN(1,3,4,7,5)
            </when>
            
            <when test="domain == 'nextwavemonitoring.com'">
                AND d.show_on_domain IN(1,5,7)
            </when>
            
            <when test="domain == 'buildings.nextwavemonitoring.com'">
                AND d.show_on_domain IN(1,6,7)
            </when>
            
            <otherwise>
		      AND d.show_on_domain IN(1,6,7)
		    </otherwise>                                                  
        </choose>
	</sql>
	
	<sql id="keyIndicatorField">
		CASE
			WHEN d.last_updated IS NULL THEN "Never"
			
			<!-- if time difference is more than 30 minutes from last updated until now and value still exist mean that the device is not sending any data from last updated, so pretending its current value as null -->
			WHEN d.field_value1 IS NOT NULL AND TIMESTAMPDIFF(MINUTE, d.last_updated, UTC_TIMESTAMP()) > 30 THEN "-"
			
			WHEN dg.table_name = 'model_power_measurement_ion_7650' AND d.field_value_default = 'kWTot' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_meter_ion_8600' AND d.field_value_default = 'kWTot' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))

			WHEN dg.table_name = 'model_meter_ion_8600v1' AND d.field_value_default = 'kWTot' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_meter_ion_8600v2' AND d.field_value_default = 'kWTot' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_meter_ion_8600v3' AND d.field_value_default = 'kWTot' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_meter_ion_8600v4' AND d.field_value_default = 'kWTot' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_aes_tx_inverter' AND d.field_value_default = 'pt33' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sma_inverter_stp62us41' AND d.field_value_default = 'GridMs_TotW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sma_inverter_stp30000tlus10' AND d.field_value_default = 'GridMs_TotW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
		
			WHEN dg.table_name = 'model_datalogger' AND d.field_value_default = 'MemFree' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kB" )))
			
			WHEN dg.table_name = 'model_solaredge_inverter' AND d.field_value_default = 'I_AC_Power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_solaredge_inverter_v1' AND d.field_value_default = 'I_AC_Power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
		
			WHEN dg.table_name = 'model_sunny_central_class9775_inverter' AND d.field_value_default = 'ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_sunny_central_class9775_inverter' AND d.field_value_default = 'ACVoltage' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "V" )))
			WHEN dg.table_name = 'model_sunny_central_class9775_inverter' AND d.field_value_default = 'InteriorTemperature' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "Degrees C" )))
			
			WHEN dg.table_name = 'model_satcon_powergate_225_inverter' AND d.field_value_default = 'OutputKW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_satcon_powergate_225_inverter' AND d.field_value_default = 'LineFreq' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Hz" )))
			WHEN dg.table_name = 'model_satcon_powergate_225_inverter' AND d.field_value_default = 'DCInputVoltage' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "V" )))
			
			WHEN dg.table_name = 'model_cell_modem' AND d.field_value_default = 'CPULoad' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "%" )))
			WHEN dg.table_name = 'model_cell_modem' AND d.field_value_default = 'Temperature' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Degrees C" )))
			WHEN dg.table_name = 'model_cell_modem' AND d.field_value_default = 'RSSI4' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", ROUND(d.field_value3, 2)))
			
			WHEN dg.table_name = 'model_adam4017ws_class8110_nelis190' AND d.field_value_default = 'POACMP11' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m^2" )))
			WHEN dg.table_name = 'model_adam4017ws_class8110_nelis190' AND d.field_value_default = 'AmbientTemp' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Degrees C" )))
			
			
			WHEN dg.table_name = 'model_campell_scientific_meter1' AND d.field_value_default = 'Meter1_ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_campell_scientific_meter2' AND d.field_value_default = 'Meter2_ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_campell_scientific_meter3' AND d.field_value_default = 'Meter3_ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_campell_scientific_meter4' AND d.field_value_default = 'Meter4_ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
		
			WHEN dg.table_name = 'model_advanced_energy_solaron' AND d.field_value_default = 'ac_power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_advanced_energy_solaron' AND d.field_value_default = 'ac_frequency' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "kW" )))
			WHEN dg.table_name = 'model_advanced_energy_solaron' AND d.field_value_default = 'pv_voltage' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "kW" )))
			
			WHEN dg.table_name = 'model_shark100' AND d.field_value_default = 'watts_3ph_total' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_shark100' AND d.field_value_default = 'vars_3ph_total' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "kVAR" )))
			WHEN dg.table_name = 'model_shark100' AND d.field_value_default = 'vas_3ph_total' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "kVA" )))
			
			WHEN dg.table_name = 'model_shark100v1' AND d.field_value_default = 'watts_3ph_total' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_shark100v1' AND d.field_value_default = 'vars_3ph_total' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "kVAR" )))
			WHEN dg.table_name = 'model_shark100v1' AND d.field_value_default = 'vas_3ph_total' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "kVA" )))
			
			
			WHEN dg.table_name = 'model_lufft_class8020' AND d.field_value_default = 'AirTemperatureActual' THEN IF(s.unit_type_temp = 2,CONCAT_WS(" ", ROUND(IFNULL((d.field_value1 * 1.8 + 32), 0 ),2), "°F" ), CONCAT_WS(" ", ROUND(IFNULL(d.field_value1, 0 ),2), "°C" ))
			WHEN dg.table_name = 'model_lufft_class8020' AND d.field_value_default = 'IrradianceActual' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "W/m²" )))

			WHEN dg.table_name = 'model_sth01_temp_sensor' AND d.field_value_default = 'TEMPRATURE' THEN IF(s.unit_type_temp = 2,CONCAT_WS(" ", ROUND(IFNULL((d.field_value1 * 1.8 + 32), 0 ),2), "°F" ), CONCAT_WS(" ", ROUND(IFNULL(d.field_value1, 0 ),2), "°C" ))
	
			WHEN dg.table_name = 'model_abb_trio_class6210' AND d.field_value_default = 'Input1Power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_abb_trio_class6210' AND d.field_value_default = 'Input1Voltage' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "V" )))
			
			WHEN dg.table_name = 'model_veris_industries_e51c2_power_meter' AND d.field_value_default = 'TotalNetInstantaneousRealPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_veris_industries_e51c2_power_meter' AND d.field_value_default = 'RealPowerPhaseA' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "kW" )))
			WHEN dg.table_name = 'model_veris_industries_e51c2_power_meter' AND d.field_value_default = 'RealPowerPhaseB' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "kW" )))
			
			WHEN dg.table_name = 'model_veris_industries_e50c2a' AND d.field_value_default = 'TotalInstantaneousRealPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_veris_industries_e50c2a' AND d.field_value_default = 'RealPowerPhaseA' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "kW" )))
			WHEN dg.table_name = 'model_veris_industries_e50c2a' AND d.field_value_default = 'RealPowerPhaseB' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "kW" )))
			
			WHEN dg.table_name = 'model_imtsolar_class8000' AND d.field_value_default = 'irradiance' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			WHEN dg.table_name = 'model_imtsolar_class8000' AND d.field_value_default = 'tcell' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "°C" )))
			
			WHEN dg.table_name = 'model_hukseflux_sr30d1_deviceclass_v0' AND d.field_value_default = 'IrradianceTcs' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m^2" )))
			WHEN dg.table_name = 'model_hukseflux_sr30d1_deviceclass_v0' AND d.field_value_default = 'SensorBodyTemperature' THEN IF(s.unit_type_temp = 2,CONCAT_WS(" ", ROUND(IFNULL((d.field_value2 * 1.8 + 32), 0 ),2), "°F" ), CONCAT_WS(" ", ROUND(IFNULL(d.field_value2, 0 ),2), "°C" ))
			WHEN dg.table_name = 'model_hukseflux_sr30d1_deviceclass_v0' AND d.field_value_default = 'IrradianceUs' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "W/m^2" )))
			
			
			WHEN dg.table_name = 'model_imtsolar_tmodul_class8006' AND d.field_value_default = 'ModuleTemperature' THEN IF(s.unit_type_temp = 2,CONCAT_WS(" ", ROUND(IFNULL((d.field_value1 * 1.8 + 32), 0 ),2), "°F" ), CONCAT_WS(" ", ROUND(IFNULL(d.field_value1, 0 ),2), "°C" ))
			
			
			WHEN dg.table_name = 'model_w_kipp_zonen_rt1' AND d.field_value_default = 'SunPOATempComp' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			WHEN dg.table_name = 'model_w_kipp_zonen_rt1' AND d.field_value_default = 'PanelTemperature' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "°C" )))
			
			WHEN dg.table_name = 'model_satcon_pvs357_inverter' AND d.field_value_default = 'Input_kW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_satcon_pvs357_inverter' AND d.field_value_default = 'Output_kw' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "kW" )))
			WHEN dg.table_name = 'model_satcon_pvs357_inverter' AND d.field_value_default = 'DC_Input_Volts' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "volts" )))
			
			WHEN dg.table_name = 'model_chint_solectria_inverter_class9725' AND d.field_value_default = 'AC_ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_chint_solectria_inverter_class9725' AND d.field_value_default = 'AC_ApparentPower' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "KVA" )))
			WHEN dg.table_name = 'model_chint_solectria_inverter_class9725' AND d.field_value_default = 'PV1_Voltage' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "VDC" )))
			
			WHEN dg.table_name = 'model_kippzonen_rt1_class8009' AND d.field_value_default = 'sensor1_data' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			WHEN dg.table_name = 'model_kippzonen_rt1_class8009' AND d.field_value_default = 'panel_temperature' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "°C" )))
			
			WHEN dg.table_name = 'model_ivt_solaron_ext' AND d.field_value_default = 'ac_power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_ivt_solaron_ext' AND d.field_value_default = 'ac_frequency' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Hz" )))
			WHEN dg.table_name = 'model_ivt_solaron_ext' AND d.field_value_default = 'pv_voltage' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "VDC" )))
			
			WHEN dg.table_name = 'model_pvp_inverter' AND d.field_value_default = 'line_kw' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_pvp_inverter' AND d.field_value_default = 'dc_output_current' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Amps" )))
			WHEN dg.table_name = 'model_pvp_inverter' AND d.field_value_default = 'dc_output_voltage' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "Volts" )))
			
			WHEN dg.table_name = 'model_rt1_class30000' AND d.field_value_default = 'sensor1_data' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			WHEN dg.table_name = 'model_rt1_class30000' AND d.field_value_default = 'panel_temperature' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "°C" )))
			
			WHEN dg.table_name = 'model_elkor_production_meter' AND d.field_value_default = 'ActivePowerTotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_elkor_production_meter' AND d.field_value_default = 'VoltageA' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Volts" )))
			WHEN dg.table_name = 'model_elkor_production_meter' AND d.field_value_default = 'VoltageB' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "Volts" )))
			
			WHEN dg.table_name = 'model_elkor_production_meterv1' AND d.field_value_default = 'ActivePowerTotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_elkor_production_meterv1' AND d.field_value_default = 'VoltageA' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Volts" )))
			WHEN dg.table_name = 'model_elkor_production_meterv1' AND d.field_value_default = 'VoltageB' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "Volts" )))
			
			WHEN dg.table_name = 'model_elkor_wattson_pv_meter' AND d.field_value_default = 'TotalRealPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_pvmet_100' AND d.field_value_default = 'TransientHorizontalIrradiance' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			WHEN dg.table_name = 'model_pvmet_100' AND d.field_value_default = 'AmbientTemperature' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "°C" )))
			WHEN dg.table_name = 'model_pvmet_100' AND d.field_value_default = 'Temperature' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "°C" )))

			WHEN dg.table_name = 'model_pvmet_200' AND d.field_value_default = 'POA_Irradiance' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			WHEN dg.table_name = 'model_pvmet_200' AND d.field_value_default = 'Ambient_Air_Temperature' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "°C" )))
			WHEN dg.table_name = 'model_pvmet_200' AND d.field_value_default = 'BOM_Temp_1' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "°C" )))
			
			WHEN dg.table_name = 'model_pv_powered_35_50_260_500kw_inverter' AND d.field_value_default = 'OutputGeneration' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_pv_powered_35_50_260_500kw_inverter' AND d.field_value_default = 'DCInputVoltage' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "V" )))
			WHEN dg.table_name = 'model_pv_powered_35_50_260_500kw_inverter' AND d.field_value_default = 'DCInputCurrent' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "" )))
			
			WHEN dg.table_name = 'model_solectria_sgi_226ivt' AND d.field_value_default = 'ACPowerOutput' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_solectria_sgi_226ivt' AND d.field_value_default = 'DCVoltage' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "VDC" )))

			WHEN dg.table_name = 'model_solectria_inv_00_slc_3146' AND d.field_value_default = 'RealACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))

			WHEN dg.table_name = 'model_tti_tracker' AND d.field_value_default = 'ReadAngle' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "Degrees" )))
			WHEN dg.table_name = 'model_tti_tracker' AND d.field_value_default = 'WindSpeed' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "m/s" )))
			
			WHEN dg.table_name = 'model_xantrex_gt100_250_500' AND d.field_value_default = 'ReadPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_xantrex_gt100_250_500' AND d.field_value_default = 'PVVoltage' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "V" )))
			WHEN dg.table_name = 'model_xantrex_gt100_250_500' AND d.field_value_default = 'PVCurrent' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "A" )))
			
			WHEN dg.table_name = 'model_xantrex_inverter' AND d.field_value_default = 'ReadPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_xantrex_inverter' AND d.field_value_default = 'PVVoltage' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "V" )))
			WHEN dg.table_name = 'model_xantrex_inverter' AND d.field_value_default = 'PVCurrent' THEN  (IF(d.field_value3 = -1 or d.field_value3 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value3, 2), "A" )))
			
			WHEN dg.table_name = 'model_sungrow_umg604' AND d.field_value_default = 'M_AC_P' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sungrow_sg110cx' AND d.field_value_default = 'P_DC' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sungrow_sg50cx' AND d.field_value_default = 'P_DC' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))

			WHEN dg.table_name = 'model_sungrow_logger1000' AND d.field_value_default = 'TotalActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))

			WHEN dg.table_name = 'model_sungrow_weather_pvmet75200' AND d.field_value_default = 'SRAD_D_H' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sma_inverter_stp1200tlus10' AND d.field_value_default = 'GridMs_TotW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_sma_inverter_stp1200tlus10' AND d.field_value_default = 'GridMs_Hz' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Hz" )))
			
			WHEN dg.table_name = 'model_sma_inverter_stp24ktlus10' AND d.field_value_default = 'GridMs_TotW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_sma_inverter_stp24ktlus10' AND d.field_value_default = 'GridMs_Hz' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Hz" )))
			
			WHEN dg.table_name = 'model_sma_cluster_controller' AND d.field_value_default = 'GridMs_TotW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_sma_cluster_controller' AND d.field_value_default = 'GridMs_Hz' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "Hz" )))		
			
			WHEN dg.table_name = 'model_poa_temp' AND d.field_value_default = 'T_AMB' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "°C" )))
			WHEN dg.table_name = 'model_pyranometer_poa' AND d.field_value_default = 'poa' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))	
			
			WHEN dg.table_name = 'model_eri_weather_icp_class8050' AND d.field_value_default = 'solar_irradiation' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			WHEN dg.table_name = 'model_eri_weather_icp_class8050' AND d.field_value_default = 'ambient_temp' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "°C" )))
			
			WHEN dg.table_name = 'model_xantrex_gt500e' AND d.field_value_default = 'AC_POWER' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_xantrex_gt500e' AND d.field_value_default = 'DC_POWER' THEN  (IF(d.field_value2 = -1 or d.field_value2 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value2, 2), "kW" )))

			WHEN dg.table_name = 'model_wattsun_tcu' AND d.field_value_default = 'ANGLE_CALC' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "Degrees" )))
			WHEN dg.table_name = 'model_wattsun_tracker' AND d.field_value_default = 'TRACKER_ANGLE' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "Degrees" )))
			WHEN dg.table_name = 'model_wattsun_tracker_master' AND d.field_value_default = 'AngleCalc' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "Degrees" )))
			WHEN dg.table_name = 'model_sun_track_tracker' AND d.field_value_default = 'CurrentAngleCalculated' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "Degrees" )))
			
			WHEN dg.table_name = 'model_sev_sg110cx' AND d.field_value_default = 'TotalActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))

			WHEN dg.table_name = 'model_elster_a1700' AND d.field_value_default = 'TotalActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_ae_refusol' AND d.field_value_default = 'ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_dts_measurelogic_demand_meter' AND d.field_value_default = 'PowerFactor_DTS_Overall' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2) )))
			
			WHEN dg.table_name = 'model_leviton_70D48000' AND d.field_value_default = 'PowerSum' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_janitza_umg604pro' AND d.field_value_default = 'TotalPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))

			WHEN dg.table_name = 'model_acu_rev_production_meter' AND d.field_value_default = 'TotalRealPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_phoenix_contact_quint_ups' AND d.field_value_default = 'StateofHealth' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "%" )))

			WHEN dg.table_name = 'model_sma_inverter_12_15_20_24_30tlus10' AND d.field_value_default = 'Power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))

			WHEN dg.table_name = 'model_sma_stp_25_50_us_50' AND d.field_value_default = 'Active_Power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_abb_uno_dm_1250tp_plus' AND d.field_value_default = 'ACActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_klea_220p' AND d.field_value_default = 'TotalActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_meter_ion_6200' AND d.field_value_default = 'kWtotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_leviton_s40000r_power_meter' AND d.field_value_default = 'TotalInstantaneousRealPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sma_inverter_stp24000tlus10' AND d.field_value_default = 'GridMs_TotW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_acuvim_IIR' AND d.field_value_default = 'SystempowerPsum' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_gas_meter' AND d.field_value_default = 'ReadingValue' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			WHEN dg.table_name = 'model_ec350_gas_meter' AND d.field_value_default = 'Energy' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "Therms" )))
			WHEN dg.table_name = 'model_water_meter' AND d.field_value_default = 'ReadingValue' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_dent_48pshd_meter' AND d.field_value_default = 'PowerSum' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_power_logic_pm8000_load_meter' AND d.field_value_default = 'ActivePowerTotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_shark250' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sol_ark_inverter' AND d.field_value_default = 'TotalActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_xgi150' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_pi_camera_water_meter' AND d.field_value_default = 'reading_value' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "gal" )))
			
			WHEN dg.table_name = 'model_QUINT4_UPS' AND d.field_value_default = 'BatteryModeTime' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1/3600, 2), "hrs" )))
			
			WHEN dg.table_name = 'model_SEL651R' AND d.field_value_default = 'BreakerStatus' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", IF(d.field_value1 = 1, "Closed", "Opened"))))
			
			WHEN dg.table_name = 'model_honeywell_emon_3200' AND d.field_value_default = 'RealPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_huawei_sun2000_28ktl' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_weather_station_bsp' AND d.field_value_default = 'TotalIrradiance' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			
			WHEN dg.table_name = 'model_smartlogger3000' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sma_shp7510' AND d.field_value_default = 'Activepower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_lovato_dmg800' AND d.field_value_default = 'EqvActivepower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_quint_ups_poso' AND d.field_value_default = 'BatteryTemperature' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "Degrees F" )))
			
			WHEN dg.table_name = 'model_sma_core' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_abb_emax_cb_ekip' AND d.field_value_default = 'ActivePower3PhaseTotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_pextron_urp6000' AND d.field_value_default = 'ActivePowerPhaseA' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_siemens_7sr11' AND d.field_value_default = 'ActivePower3PhaseTotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_thermtronic_th104bus' AND d.field_value_default = 'AmbientMeasuredMaximumTemperature' THEN IF(s.unit_type_temp = 2,CONCAT_WS(" ", ROUND(IFNULL((d.field_value1 * 1.8 + 32), 0 ),2), "°F" ), CONCAT_WS(" ", ROUND(IFNULL(d.field_value1, 0 ),2), "°C" ))
			
			WHEN dg.table_name = 'model_ginlong_solis_inverter_class6007' AND d.field_value_default = 'Activeower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_imtsolar_tv_class8004' AND d.field_value_default = 'irradiance' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			
			WHEN dg.table_name = 'model_Kehua_SPI50_60K_inverter' AND d.field_value_default = 'Ongridactivepower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_Hukseflux_HB500' AND d.field_value_default = 'poa' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			
			
			
			ELSE "-"
		END AS key_indicator
	</sql>
	
	<sql id="unitField">
		CASE
			WHEN dg.table_name = 'model_power_measurement_ion_7650' AND d.field_value_default = 'kWTot' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_meter_ion_8600' AND d.field_value_default = 'kWTot' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_meter_ion_8600v1' AND d.field_value_default = 'kWTot' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_meter_ion_8600v2' AND d.field_value_default = 'kWTot' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_aes_tx_inverter' AND d.field_value_default = 'pt33' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_sma_inverter_stp62us41' AND d.field_value_default = 'GridMs_TotW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_sma_inverter_stp30000tlus10' AND d.field_value_default = 'GridMs_TotW' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
		
			WHEN dg.table_name = 'model_datalogger' AND d.field_value_default = 'MemFree' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kB"))
			
			WHEN dg.table_name = 'model_solaredge_inverter' AND d.field_value_default = 'I_AC_Power' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_solaredge_inverter_v1' AND d.field_value_default = 'I_AC_Power' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
		
			WHEN dg.table_name = 'model_sunny_central_class9775_inverter' AND d.field_value_default = 'ACPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_sunny_central_class9775_inverter' AND d.field_value_default = 'ACVoltage' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "V"))
			WHEN dg.table_name = 'model_sunny_central_class9775_inverter' AND d.field_value_default = 'InteriorTemperature' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_satcon_powergate_225_inverter' AND d.field_value_default = 'OutputKW' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_satcon_powergate_225_inverter' AND d.field_value_default = 'LineFreq' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Hz"))
			WHEN dg.table_name = 'model_satcon_powergate_225_inverter' AND d.field_value_default = 'DCInputVoltage' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "V"))
			
			WHEN dg.table_name = 'model_cell_modem' AND d.field_value_default = 'CPULoad' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "%"))
			WHEN dg.table_name = 'model_cell_modem' AND d.field_value_default = 'Temperature' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_adam4017ws_class8110_nelis190' AND d.field_value_default = 'POACMP11' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m^2"))
			WHEN dg.table_name = 'model_adam4017ws_class8110_nelis190' AND d.field_value_default = 'AmbientTemp' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_campell_scientific_meter1' AND d.field_value_default = 'Meter1_ACPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_campell_scientific_meter2' AND d.field_value_default = 'Meter2_ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_campell_scientific_meter3' AND d.field_value_default = 'Meter3_ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_campell_scientific_meter4' AND d.field_value_default = 'Meter4_ACPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
		
			WHEN dg.table_name = 'model_advanced_energy_solaron' AND d.field_value_default = 'ac_power' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_advanced_energy_solaron' AND d.field_value_default = 'ac_frequency' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_advanced_energy_solaron' AND d.field_value_default = 'pv_voltage' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_shark100' AND d.field_value_default = 'watts_3ph_total' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_shark100' AND d.field_value_default = 'vars_3ph_total' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kVAR"))
			WHEN dg.table_name = 'model_shark100' AND d.field_value_default = 'vas_3ph_total' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kVA"))
			
			WHEN dg.table_name = 'model_lufft_class8020' AND d.field_value_default = 'AirTemperatureActual' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			WHEN dg.table_name = 'model_lufft_class8020' AND d.field_value_default = 'IrradianceActual' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))

			WHEN dg.table_name = 'model_sth01_temp_sensor' AND d.field_value_default = 'TEMPRATURE' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_abb_trio_class6210' AND d.field_value_default = 'Input1Power' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_abb_trio_class6210' AND d.field_value_default = 'Input1Voltage' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "V"))
			
			WHEN dg.table_name = 'model_veris_industries_e51c2_power_meter' AND d.field_value_default = 'TotalNetInstantaneousRealPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_veris_industries_e51c2_power_meter' AND d.field_value_default = 'RealPowerPhaseA' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_veris_industries_e51c2_power_meter' AND d.field_value_default = 'RealPowerPhaseB' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_veris_industries_e50c2a' AND d.field_value_default = 'TotalInstantaneousRealPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_veris_industries_e50c2a' AND d.field_value_default = 'RealPowerPhaseA' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_veris_industries_e50c2a' AND d.field_value_default = 'RealPowerPhaseB' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_imtsolar_class8000' AND d.field_value_default = 'irradiance' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
			WHEN dg.table_name = 'model_imtsolar_class8000' AND d.field_value_default = 'tcell' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_hukseflux_sr30d1_deviceclass_v0' AND d.field_value_default = 'IrradianceTcs' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
			WHEN dg.table_name = 'model_hukseflux_sr30d1_deviceclass_v0' AND d.field_value_default = 'SensorBodyTemperature' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			WHEN dg.table_name = 'model_hukseflux_sr30d1_deviceclass_v0' AND d.field_value_default = 'IrradianceUs' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
							
			WHEN dg.table_name = 'model_imtsolar_tmodul_class8006' AND d.field_value_default = 'ModuleTemperature' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_w_kipp_zonen_rt1' AND d.field_value_default = 'SunPOATempComp' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
			WHEN dg.table_name = 'model_w_kipp_zonen_rt1' AND d.field_value_default = 'PanelTemperature' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_satcon_pvs357_inverter' AND d.field_value_default = 'Input_kW' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_satcon_pvs357_inverter' AND d.field_value_default = 'Output_kw' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_satcon_pvs357_inverter' AND d.field_value_default = 'DC_Input_Volts' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "volts"))
			
			WHEN dg.table_name = 'model_chint_solectria_inverter_class9725' AND d.field_value_default = 'AC_ActivePower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_chint_solectria_inverter_class9725' AND d.field_value_default = 'AC_ApparentPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "KVA"))
			WHEN dg.table_name = 'model_chint_solectria_inverter_class9725' AND d.field_value_default = 'PV1_Voltage' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "VDC"))
			
			WHEN dg.table_name = 'model_kippzonen_rt1_class8009' AND d.field_value_default = 'sensor1_data' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
			WHEN dg.table_name = 'model_kippzonen_rt1_class8009' AND d.field_value_default = 'panel_temperature' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_ivt_solaron_ext' AND d.field_value_default = 'ac_power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_ivt_solaron_ext' AND d.field_value_default = 'ac_frequency' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Hz"))
			WHEN dg.table_name = 'model_ivt_solaron_ext' AND d.field_value_default = 'pv_voltage' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "VDC"))
			
			WHEN dg.table_name = 'model_pvp_inverter' AND d.field_value_default = 'line_kw' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_pvp_inverter' AND d.field_value_default = 'dc_output_current' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Amps"))
			WHEN dg.table_name = 'model_pvp_inverter' AND d.field_value_default = 'dc_output_voltage' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Volts"))
			
			WHEN dg.table_name = 'model_rt1_class30000' AND d.field_value_default = 'sensor1_data' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
			WHEN dg.table_name = 'model_rt1_class30000' AND d.field_value_default = 'panel_temperature' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_elkor_production_meter' AND d.field_value_default = 'ActivePowerTotal' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_elkor_production_meter' AND d.field_value_default = 'VoltageA' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Volts"))
			WHEN dg.table_name = 'model_elkor_production_meter' AND d.field_value_default = 'VoltageB' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Volts"))
			
			WHEN dg.table_name = 'model_elkor_wattson_pv_meter' AND d.field_value_default = 'TotalRealPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_pvmet_100' AND d.field_value_default = 'TransientHorizontalIrradiance' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
			WHEN dg.table_name = 'model_pvmet_100' AND d.field_value_default = 'AmbientTemperature' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			WHEN dg.table_name = 'model_pvmet_100' AND d.field_value_default = 'Temperature' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))

			WHEN dg.table_name = 'model_pvmet_200' AND d.field_value_default = 'POA_Irradiance' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
			WHEN dg.table_name = 'model_pvmet_200' AND d.field_value_default = 'Ambient_Air_Temperature' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			WHEN dg.table_name = 'model_pvmet_200' AND d.field_value_default = 'BOM_Temp_1' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
				
			WHEN dg.table_name = 'model_pv_powered_35_50_260_500kw_inverter' AND d.field_value_default = 'OutputGeneration' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_pv_powered_35_50_260_500kw_inverter' AND d.field_value_default = 'DCInputVoltage' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "V"))
			
			WHEN dg.table_name = 'model_solectria_sgi_226ivt' AND d.field_value_default = 'ACPowerOutput' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_solectria_sgi_226ivt' AND d.field_value_default = 'DCVoltage' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "VDC"))

			WHEN dg.table_name = 'model_solectria_inv_00_slc_3146' AND d.field_value_default = 'RealACPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
	
			WHEN dg.table_name = 'model_tti_tracker' AND d.field_value_default = 'ReadAngle' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees"))
			WHEN dg.table_name = 'model_tti_tracker' AND d.field_value_default = 'WindSpeed' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "m/s"))
			
			WHEN dg.table_name = 'model_xantrex_gt100_250_500' AND d.field_value_default = 'ReadPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_xantrex_gt100_250_500' AND d.field_value_default = 'PVVoltage' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "V"))
			WHEN dg.table_name = 'model_xantrex_gt100_250_500' AND d.field_value_default = 'PVCurrent' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "A"))
			
			WHEN dg.table_name = 'model_xantrex_inverter' AND d.field_value_default = 'ReadPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_xantrex_inverter' AND d.field_value_default = 'PVVoltage' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "V"))
			WHEN dg.table_name = 'model_xantrex_inverter' AND d.field_value_default = 'PVCurrent' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "A"))
			
			WHEN dg.table_name = 'model_sungrow_umg604' AND d.field_value_default = 'M_AC_P' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_sungrow_sg110cx' AND d.field_value_default = 'P_DC' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_sungrow_sg50cx' AND d.field_value_default = 'P_DC' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_sungrow_logger1000' AND d.field_value_default = 'TotalActivePower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_sungrow_weather_pvmet75200' AND d.field_value_default = 'SRAD_D_H' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_sma_inverter_stp1200tlus10' AND d.field_value_default = 'GridMs_TotW' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_sma_inverter_stp1200tlus10' AND d.field_value_default = 'GridMs_Hz' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Hz"))
			
			WHEN dg.table_name = 'model_sma_inverter_stp24ktlus10' AND d.field_value_default = 'GridMs_TotW' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_sma_inverter_stp24ktlus10' AND d.field_value_default = 'GridMs_Hz' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Hz"))
			
			WHEN dg.table_name = 'model_sma_cluster_controller' AND d.field_value_default = 'GridMs_TotW' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_sma_cluster_controller' AND d.field_value_default = 'GridMs_Hz' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Hz"))
			
			WHEN dg.table_name = 'model_poa_temp' AND d.field_value_default = 'T_AMB' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			WHEN dg.table_name = 'model_pyranometer_poa' AND d.field_value_default = 'poa' THEN  "W/m²"
			
			WHEN dg.table_name = 'model_eri_weather_icp_class8050' AND d.field_value_default = 'solar_irradiation' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "W/m²"))
			WHEN dg.table_name = 'model_eri_weather_icp_class8050' AND d.field_value_default = 'ambient_temp' THEN   (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C")) 
			
			WHEN dg.table_name = 'model_xantrex_gt500e' AND d.field_value_default = 'AC_POWER' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			WHEN dg.table_name = 'model_xantrex_gt500e' AND d.field_value_default = 'DC_POWER' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_wattsun_tcu' AND d.field_value_default = 'ANGLE_CALC' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees"))
			WHEN dg.table_name = 'model_wattsun_tracker' AND d.field_value_default = 'TRACKER_ANGLE' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees"))
			WHEN dg.table_name = 'model_wattsun_tracker_master' AND d.field_value_default = 'AngleCalc' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees"))
			WHEN dg.table_name = 'model_sun_track_tracker' AND d.field_value_default = 'CurrentAngleCalculated' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees"))
			
			WHEN dg.table_name = 'model_sev_sg110cx' AND d.field_value_default = 'TotalActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_elster_a1700' AND d.field_value_default = 'TotalActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_ae_refusol' AND d.field_value_default = 'ACPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_dts_measurelogic_demand_meter' AND d.field_value_default = 'PowerFactor_DTS_Overall' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_leviton_70D48000' AND d.field_value_default = 'PowerSum' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_janitza_umg604pro' AND d.field_value_default = 'TotalPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_acu_rev_production_meter' AND d.field_value_default = 'TotalRealPower' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_phoenix_contact_quint_ups' AND d.field_value_default = 'StateofHealth' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "%"))

	        WHEN dg.table_name = 'model_sma_inverter_12_15_20_24_30tlus10' AND d.field_value_default = 'Power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_meter_ion_6200' AND d.field_value_default = 'kWtotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_sma_stp_25_50_us_50' AND d.field_value_default = 'Active_Power' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))

			WHEN dg.table_name = 'model_acuvim_IIR' AND d.field_value_default = 'SystempowerPsum' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_power_logic_pm8000_load_meter' AND d.field_value_default = 'ActivePowerTotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_xgi150' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_pi_camera_water_meter' AND d.field_value_default = 'reading_value' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "gal" )))
			
			WHEN dg.table_name = 'model_QUINT4_UPS' AND d.field_value_default = 'BatteryModeTime' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1/3600, 2), "hrs" )))
			
			WHEN dg.table_name = 'model_SEL651R' AND d.field_value_default = 'BreakerStatus' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", IF(d.field_value1 = 1, "Closed", "Opened"))))

			WHEN dg.table_name = 'model_honeywell_emon_3200' AND d.field_value_default = 'RealPower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_huawei_sun2000_28ktl' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_weather_station_bsp' AND d.field_value_default = 'TotalIrradiance' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			
			WHEN dg.table_name = 'model_smartlogger3000' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_sma_shp7510' AND d.field_value_default = 'Activepower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_lovato_dmg800' AND d.field_value_default = 'EqvActivepower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))

			WHEN dg.table_name = 'model_quint_ups_poso' AND d.field_value_default = 'BatteryTemperature' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "Degrees F" )))
			
			WHEN dg.table_name = 'model_sma_core' AND d.field_value_default = 'ActivePower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_abb_emax_cb_ekip' AND d.field_value_default = 'ActivePower3PhaseTotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_pextron_urp6000' AND d.field_value_default = 'ActivePowerPhaseA' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_siemens_7sr11' AND d.field_value_default = 'ActivePower3PhaseTotal' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "kW"))
			
			WHEN dg.table_name = 'model_thermtronic_th104bus' AND d.field_value_default = 'AmbientMeasuredMaximumTemperature' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Degrees C"))
			
			WHEN dg.table_name = 'model_ec350_gas_meter' AND d.field_value_default = 'Energy' THEN (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "Z", "Therms"))
			
			WHEN dg.table_name = 'model_ginlong_solis_inverter_class6007' AND d.field_value_default = 'Activeower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_imtsolar_tv_class8004' AND d.field_value_default = 'irradiance' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
			
			WHEN dg.table_name = 'model_Kehua_SPI50_60K_inverter' AND d.field_value_default = 'Ongridactivepower' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "kW" )))
			
			WHEN dg.table_name = 'model_Hukseflux_HB500' AND d.field_value_default = 'poa' THEN  (IF(d.field_value1 = -1 or d.field_value1 IS NULL, "-", CONCAT_WS(" ", ROUND(d.field_value1, 2), "W/m²" )))
						
			
			ELSE "Z"
			
		END AS unit
	</sql>
	
	<sql id="siteName">
		<choose> 
            <when test="domain == 'demo.nextwavemonitoring.com' || domain_role == '1ff1de774005f8da13f42943881c655f'">
				CONCAT_WS("", "Site", " #", s.id)
            </when>
            <otherwise>
				s.name
		    </otherwise>                                                  
        </choose>
	</sql>
	
	<sql id="siteGroupName">
		<choose> 
            <when test="domain == 'demo.nextwavemonitoring.com' || domain_role == '1ff1de774005f8da13f42943881c655f'">
				CONCAT_WS("", ssg.id, " #group")
            </when>
            <otherwise>
				ssg.name
		    </otherwise>                                                  
        </choose>
	</sql>
	
	<sql id="expectedPowerByPvModel">
		CASE s.pv_model
			WHEN 1 THEN
				IF(
					IFNULL(s.dc_capacity * (${irradiance} / s.global_solar_irradiance_at_stc) * (1 - (IFNULL(s.pv_module_temperature_coeff, -0.43)/100) * (s.stc_temperature - ${temperature})) * (1 - IFNULL(s.system_loss, 9)/100) * IFNULL(s.inverter_efficiency, 96)/100, 0) <![CDATA[<]]> s.ac_capacity,
					s.dc_capacity * (${irradiance} / s.global_solar_irradiance_at_stc) * (1 - (IFNULL(s.pv_module_temperature_coeff, -0.43)/100) * (s.stc_temperature - ${temperature})) * (1 - IFNULL(s.system_loss, 9)/100) * IFNULL(s.inverter_efficiency, 96)/100,
					s.ac_capacity
				)
			WHEN 2 THEN
		 		IFNULL(s.dc_capacity * (${irradiance} / s.global_solar_irradiance_at_stc) * (1 - (1 + (IFNULL(s.pv_module_temperature_coeff, -0.43)/100)) * ((IF(${panelTemperature} > 0, ${panelTemperature}, ${temperature}) - s.stc_temperature)/100)) * (POW(1 - (IFNULL(s.annual_pv_module_degradation, 0.5)/100), YEAR(CURRENT_TIMESTAMP) - IFNULL(YEAR(s.commissioning), YEAR(s.built_since)))) * (1 - (IFNULL(s.soiling, 5)/100)) * (1 - (IFNULL(s.cable_losses, 1)/100)) * (1 - (IFNULL(s.transformer_losses, 1.5)/100)) * (1 - (IFNULL(s.other_losses, 1.5)/100)) * (IFNULL(s.inverter_efficiency, 98.5)/100), 0)
			WHEN 3 THEN
				IF(
					(${irradiance} >= s.min_irradiance_limit) AND (IF(${power} > (s.ac_capacity * IFNULL(s.clip, 99)/100), 1, 0) = 0),
					s.dc_capacity * (${irradiance} / s.global_solar_irradiance_at_stc) * (1 - IFNULL(s.pv_module_temperature_coeff, -0.37)/100 * (s.t_avg - (${temperature} + ${irradiance}/s.global_solar_irradiance_at_stc * 3))) * IFNULL(s.inverter_efficiency, 100)/100,
					NULL
				)
			ELSE NULL
		END
	</sql>
</mapper>