<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ModelSmaStp2550us50">
	<resultMap id="ModelSmaStp2550us50Map" type="com.nwm.api.entities.ModelSmaStp2550us50Entity">
			<result property="time" column="time" />
			<result property="id_device" column="id_device" />
			<result property="error" column="error" />
			<result property="low_alarm" column="low_alarm" />
			<result property="high_alarm" column="high_alarm" />
			
			<result property="Grid_Frequency" column="Grid_Frequency" />
			<result property="Apparent_Power" column="Apparent_Power" />
			<result property="Reactive_Power" column="Reactive_Power" />
			<result property="Active_Power" column="Active_Power" />
			<result property="Power_Factor" column="Power_Factor" />
			<result property="Grid_Current" column="Grid_Current" />
			<result property="Current_Phase_1" column="Current_Phase_1" />
			<result property="Current_Phase_2" column="Current_Phase_2" />
			<result property="Current_Phase_3" column="Current_Phase_3" />
			<result property="Active_Power_Phase_1" column="Active_Power_Phase_1" />
			<result property="Active_Power_Phase_2" column="Active_Power_Phase_2" />
			<result property="Active_Power_Phase_3" column="Active_Power_Phase_3" />
			<result property="Reactive_Power_Phase_1" column="Reactive_Power_Phase_1" />
			<result property="Reactive_Power_Phase_2" column="Reactive_Power_Phase_2" />
			<result property="Reactive_Power_Phase_3" column="Reactive_Power_Phase_3" />
			<result property="Apparent_Power_Phase_1" column="Apparent_Power_Phase_1" />
			<result property="Apparent_Power_Phase_2" column="Apparent_Power_Phase_2" />
			<result property="Apparent_Power_Phase_3" column="Apparent_Power_Phase_3" />
			<result property="Voltage_Phase_1" column="Voltage_Phase_1" />
			<result property="Voltage_Phase_2" column="Voltage_Phase_2" />
			<result property="Voltage_Phase_3" column="Voltage_Phase_3" />
			<result property="Voltage_Phase_1_2" column="Voltage_Phase_1_2" />
			<result property="Voltage_Phase_2_3" column="Voltage_Phase_2_3" />
			<result property="Voltage_Phase_3_1" column="Voltage_Phase_3_1" />
			<result property="Residual_DC_Current" column="Residual_DC_Current" />
			<result property="Insulation_Resistance" column="Insulation_Resistance" />
			<result property="Feed_In_Time" column="Feed_In_Time" />
			<result property="Operating_Time" column="Operating_Time" />
			<result property="Total_Yield" column="Total_Yield" />
			<result property="Internal_Temperature" column="Internal_Temperature" />
			<result property="DC_Current_Input_1" column="DC_Current_Input_1" />
			<result property="DC_Current_Input_2" column="DC_Current_Input_2" />
			<result property="DC_Current_Input_3" column="DC_Current_Input_3" />
			<result property="DC_Current_Input_4" column="DC_Current_Input_4" />			
			<result property="DC_Voltage_Input_1" column="DC_Voltage_Input_1" />
			<result property="DC_Voltage_Input_2" column="DC_Voltage_Input_2" />
			<result property="DC_Voltage_Input_3" column="DC_Voltage_Input_3" />
			<result property="DC_Voltage_Input_4" column="DC_Voltage_Input_4" />
			<result property="DC_Power_Input_1" column="DC_Power_Input_1" />
			<result property="DC_Power_Input_2" column="DC_Power_Input_2" />
			<result property="DC_Power_Input_3" column="DC_Power_Input_3" />
			<result property="DC_Power_Input_4" column="DC_Power_Input_4" />
			
		    <result property="nvmActivePower" column="nvmActivePower" />
		    <result property="nvmActiveEnergy" column="nvmActiveEnergy" />
		    <result property="MeasuredProduction" column="MeasuredProduction" />
		    <result property="datatablename" column="datatablename" />
			<result property="view_tablename" column="view_tablename" />
			<result property="job_tablename" column="job_tablename" />
	</resultMap>

	<insert id="insertModelSmaStp2550us50" useGeneratedKeys="true" keyProperty="time">
		INSERT INTO `${datatablename}`
		<trim prefix="(" suffix=")" suffixOverrides="," >
			<if test="time != null" >
	        	`time`,
	        </if>
			<if test="id_device != 0.001" >
	            `id_device`,
	        </if>
			<if test="error != 0.001" >
	            `error`,
	        </if>
			<if test="low_alarm != 0.001" >
	            `low_alarm`,
	        </if>
			<if test="high_alarm != 0.001" >
	            `high_alarm`,
	        </if>
			<if test="Grid_Frequency != 0.001" >
				`Grid_Frequency`,
			</if>
			<if test="Apparent_Power != 0.001" >
				`Apparent_Power`,
			</if>
			<if test="Reactive_Power != 0.001" >
				`Reactive_Power`,
			</if>
			<if test="Active_Power != 0.001" >
				`Active_Power`,
			</if>
			<if test="Power_Factor != 0.001" >
				`Power_Factor`,
			</if>
			<if test="Grid_Current != 0.001" >
				`Grid_Current`,
			</if>
			<if test="Current_Phase_1 != 0.001" >
				`Current_Phase_1`,
			</if>
			<if test="Current_Phase_2 != 0.001" >
				`Current_Phase_2`,
			</if>
			<if test="Current_Phase_3 != 0.001" >
				`Current_Phase_3`,
			</if>
			<if test="Active_Power_Phase_1 != 0.001" >
				`Active_Power_Phase_1`,
			</if>
			<if test="Active_Power_Phase_2 != 0.001" >
				`Active_Power_Phase_2`,
			</if>
			<if test="Active_Power_Phase_3 != 0.001" >
				`Active_Power_Phase_3`,
			</if>
			<if test="Reactive_Power_Phase_1 != 0.001" >
				`Reactive_Power_Phase_1`,
			</if>
			<if test="Reactive_Power_Phase_2 != 0.001" >
				`Reactive_Power_Phase_2`,
			</if>
			<if test="Reactive_Power_Phase_3 != 0.001" >
				`Reactive_Power_Phase_3`,
			</if>
			<if test="Apparent_Power_Phase_1 != 0.001" >
				`Apparent_Power_Phase_1`,
			</if>
			<if test="Apparent_Power_Phase_2 != 0.001" >
				`Apparent_Power_Phase_2`,
			</if>
			<if test="Apparent_Power_Phase_3 != 0.001" >
				`Apparent_Power_Phase_3`,
			</if>
			<if test="Voltage_Phase_1 != 0.001" >
				`Voltage_Phase_1`,
			</if>
			<if test="Voltage_Phase_2 != 0.001" >
				`Voltage_Phase_2`,
			</if>
			<if test="Voltage_Phase_3 != 0.001" >
				`Voltage_Phase_3`,
			</if>
			<if test="Voltage_Phase_1_2 != 0.001" >
				`Voltage_Phase_1_2`,
			</if>
			<if test="Voltage_Phase_2_3 != 0.001" >
				`Voltage_Phase_2_3`,
			</if>
			<if test="Voltage_Phase_3_1 != 0.001" >
				`Voltage_Phase_3_1`,
			</if>
			<if test="Residual_DC_Current != 0.001" >
				`Residual_DC_Current`,
			</if>
			<if test="Insulation_Resistance != 0.001" >
				`Insulation_Resistance`,
			</if>
			<if test="Feed_In_Time != 0.001" >
				`Feed_In_Time`,
			</if>
			<if test="Operating_Time != 0.001" >
				`Operating_Time`,
			</if>
			<if test="Total_Yield != 0.001" >
				`Total_Yield`,
			</if>
			<if test="Internal_Temperature != 0.001" >
				`Internal_Temperature`,
			</if>
			<if test="DC_Current_Input_1 != 0.001" >
				`DC_Current_Input_1`,
			</if>
			<if test="DC_Current_Input_2 != 0.001" >
				`DC_Current_Input_2`,
			</if>
			<if test="DC_Current_Input_3 != 0.001" >
				`DC_Current_Input_3`,
			</if>
			<if test="DC_Current_Input_4 != 0.001" >
				`DC_Current_Input_4`,
			</if>			
			<if test="DC_Voltage_Input_1 != 0.001" >
				`DC_Voltage_Input_1`,
			</if>
			<if test="DC_Voltage_Input_2 != 0.001" >
				`DC_Voltage_Input_2`,
			</if>
			<if test="DC_Voltage_Input_3 != 0.001" >
				`DC_Voltage_Input_3`,
			</if>
			<if test="DC_Voltage_Input_4 != 0.001" >
				`DC_Voltage_Input_4`,
			</if>
			<if test="DC_Power_Input_1 != 0.001" >
				`DC_Power_Input_1`,
			</if>
			<if test="DC_Power_Input_2 != 0.001" >
				`DC_Power_Input_2`,
			</if>
			<if test="DC_Power_Input_3 != 0.001" >
				`DC_Power_Input_3`,
			</if>
			<if test="DC_Power_Input_4 != 0.001" >
				`DC_Power_Input_4`,
			</if>
			
			<if test="EventMessage != 0.001" >
				`EventMessage`,
			</if>	
			
			<if test="HealthCondition != 0.001" >
				`HealthCondition`,
			</if>	
			
			<if test="FaultCorrectionMeasure != 0.001" >
				`FaultCorrectionMeasure`,
			</if>	
			<if test="BlockStatus != 0.001" >
				`BlockStatus`,
			</if>	
			<if test="ReasonforDerating != 0.001" >
				`ReasonforDerating`,
			</if>	
				
			
			<if test="nvmActivePower != 0.001" >
			  	`nvmActivePower`,
			</if>
			<if test="nvmActiveEnergy != 0.001" >
			  	`nvmActiveEnergy`,
			</if>
			<if test="MeasuredProduction != 0.001">
				`MeasuredProduction`,
			</if>
		</trim>
		
		<trim prefix="values (" suffix=")" suffixOverrides="," >
			<if test="time != null" >
                #{time},
	        </if>
			<if test="id_device != 0.001" >
                #{id_device},
	        </if>
			<if test="error != 0.001" >
	        	#{error},
	        </if>
			<if test="low_alarm != 0.001" >
	            #{low_alarm},
	        </if>
			<if test="high_alarm != 0.001" >
	        	#{high_alarm},
	        </if>
			<if test="Grid_Frequency != 0.001" >
				#{Grid_Frequency},
			</if>
			<if test="Apparent_Power != 0.001" >
				#{Apparent_Power},
			</if>
			<if test="Reactive_Power != 0.001" >
				#{Reactive_Power},
			</if>
			<if test="Active_Power != 0.001" >
				#{Active_Power},
			</if>
			<if test="Power_Factor != 0.001" >
				#{Power_Factor},
			</if>
			<if test="Grid_Current != 0.001" >
				#{Grid_Current},
			</if>
			<if test="Current_Phase_1 != 0.001" >
				#{Current_Phase_1},
			</if>
			<if test="Current_Phase_2 != 0.001" >
				#{Current_Phase_2},
			</if>
			<if test="Current_Phase_3 != 0.001" >
				#{Current_Phase_3},
			</if>
			<if test="Active_Power_Phase_1 != 0.001" >
				#{Active_Power_Phase_1},
			</if>
			<if test="Active_Power_Phase_2 != 0.001" >
				#{Active_Power_Phase_2},
			</if>
			<if test="Active_Power_Phase_3 != 0.001" >
				#{Active_Power_Phase_3},
			</if>
			<if test="Reactive_Power_Phase_1 != 0.001" >
				#{Reactive_Power_Phase_1},
			</if>
			<if test="Reactive_Power_Phase_2 != 0.001" >
				#{Reactive_Power_Phase_2},
			</if>
			<if test="Reactive_Power_Phase_3 != 0.001" >
				#{Reactive_Power_Phase_3},
			</if>
			<if test="Apparent_Power_Phase_1 != 0.001" >
				#{Apparent_Power_Phase_1},
			</if>
			<if test="Apparent_Power_Phase_2 != 0.001" >
				#{Apparent_Power_Phase_2},
			</if>
			<if test="Apparent_Power_Phase_3 != 0.001" >
				#{Apparent_Power_Phase_3},
			</if>
			<if test="Voltage_Phase_1 != 0.001" >
				#{Voltage_Phase_1},
			</if>
			<if test="Voltage_Phase_2 != 0.001" >
				#{Voltage_Phase_2},
			</if>
			<if test="Voltage_Phase_3 != 0.001" >
				#{Voltage_Phase_3},
			</if>
			<if test="Voltage_Phase_1_2 != 0.001" >
				#{Voltage_Phase_1_2},
			</if>
			<if test="Voltage_Phase_2_3 != 0.001" >
				#{Voltage_Phase_2_3},
			</if>
			<if test="Voltage_Phase_3_1 != 0.001" >
				#{Voltage_Phase_3_1},
			</if>
			<if test="Residual_DC_Current != 0.001" >
				#{Residual_DC_Current},
			</if>
			<if test="Insulation_Resistance != 0.001" >
				#{Insulation_Resistance},
			</if>
			<if test="Feed_In_Time != 0.001" >
				#{Feed_In_Time},
			</if>
			<if test="Operating_Time != 0.001" >
				#{Operating_Time},
			</if>
			<if test="Total_Yield != 0.001" >
				#{Total_Yield},
			</if>
			<if test="Internal_Temperature != 0.001" >
				#{Internal_Temperature},
			</if>
			<if test="DC_Current_Input_1 != 0.001" >
				#{DC_Current_Input_1},
			</if>
			<if test="DC_Current_Input_2 != 0.001" >
				#{DC_Current_Input_2},
			</if>
			<if test="DC_Current_Input_3 != 0.001" >
				#{DC_Current_Input_3},
			</if>
			<if test="DC_Current_Input_4 != 0.001" >
				#{DC_Current_Input_4},
			</if>			
			<if test="DC_Voltage_Input_1 != 0.001" >
				#{DC_Voltage_Input_1},
			</if>
			<if test="DC_Voltage_Input_2 != 0.001" >
				#{DC_Voltage_Input_2},
			</if>
			<if test="DC_Voltage_Input_3 != 0.001" >
				#{DC_Voltage_Input_3},
			</if>
			<if test="DC_Voltage_Input_4 != 0.001" >
				#{DC_Voltage_Input_4},
			</if>
			<if test="DC_Power_Input_1 != 0.001" >
				#{DC_Power_Input_1},
			</if>
			<if test="DC_Power_Input_2 != 0.001" >
				#{DC_Power_Input_2},
			</if>
			<if test="DC_Power_Input_3 != 0.001" >
				#{DC_Power_Input_3},
			</if>
			<if test="DC_Power_Input_4 != 0.001" >
				#{DC_Power_Input_4},
			</if>		
			
			<if test="EventMessage != 0.001" >
				#{EventMessage},
			</if>	
			
			<if test="HealthCondition != 0.001" >
				#{HealthCondition},
			</if>	
			
			<if test="FaultCorrectionMeasure != 0.001" >
				#{FaultCorrectionMeasure},
			</if>	
			<if test="BlockStatus != 0.001" >
				#{BlockStatus},
			</if>	
			<if test="ReasonforDerating != 0.001" >
				#{ReasonforDerating},
			</if>	
			
			<if test="nvmActivePower != 0.001" >
			  	#{nvmActivePower},
			</if>
			<if test="nvmActiveEnergy != 0.001" >
			  	#{nvmActiveEnergy},
			</if>
			<if test="MeasuredProduction != 0.001">
				#{MeasuredProduction},
			</if>
		</trim>
		
		<trim prefix="ON DUPLICATE KEY UPDATE " suffix=""
			suffixOverrides=",">
			<if test="id_device != 0.001" >
	        	`id_device` = #{id_device},
	        </if>
			<if test="error != 0.001" >
	        	`error` = #{error},
	        </if>
			<if test="low_alarm != 0.001" >
	            `low_alarm` = #{low_alarm},
	        </if>
			<if test="high_alarm != 0.001" >
	            `high_alarm` = #{high_alarm},
	        </if>
			<if test="Grid_Frequency != 0.001" >
				`Grid_Frequency` = #{Grid_Frequency},
			</if>
			<if test="Apparent_Power != 0.001" >
				`Apparent_Power` = #{Apparent_Power},
			</if>
			<if test="Reactive_Power != 0.001" >
				`Reactive_Power` = #{Reactive_Power},
			</if>
			<if test="Active_Power != 0.001" >
				`Active_Power` = #{Active_Power},
			</if>
			<if test="Power_Factor != 0.001" >
				`Power_Factor` = #{Power_Factor},
			</if>
			<if test="Grid_Current != 0.001" >
				`Grid_Current` = #{Grid_Current},
			</if>
			<if test="Current_Phase_1 != 0.001" >
				`Current_Phase_1` = #{Current_Phase_1},
			</if>
			<if test="Current_Phase_2 != 0.001" >
				`Current_Phase_2` = #{Current_Phase_2},
			</if>
			<if test="Current_Phase_3 != 0.001" >
				`Current_Phase_3` = #{Current_Phase_3},
			</if>
			<if test="Active_Power_Phase_1 != 0.001" >
				`Active_Power_Phase_1` = #{Active_Power_Phase_1},
			</if>
			<if test="Active_Power_Phase_2 != 0.001" >
				`Active_Power_Phase_2` = #{Active_Power_Phase_2},
			</if>
			<if test="Active_Power_Phase_3 != 0.001" >
				`Active_Power_Phase_3` = #{Active_Power_Phase_3},
			</if>
			<if test="Reactive_Power_Phase_1 != 0.001" >
				`Reactive_Power_Phase_1` = #{Reactive_Power_Phase_1},
			</if>
			<if test="Reactive_Power_Phase_2 != 0.001" >
				`Reactive_Power_Phase_2` = #{Reactive_Power_Phase_2},
			</if>
			<if test="Reactive_Power_Phase_3 != 0.001" >
				`Reactive_Power_Phase_3` = #{Reactive_Power_Phase_3},
			</if>
			<if test="Apparent_Power_Phase_1 != 0.001" >
				`Apparent_Power_Phase_1` = #{Apparent_Power_Phase_1},
			</if>
			<if test="Apparent_Power_Phase_2 != 0.001" >
				`Apparent_Power_Phase_2` = #{Apparent_Power_Phase_2},
			</if>
			<if test="Apparent_Power_Phase_3 != 0.001" >
				`Apparent_Power_Phase_3` = #{Apparent_Power_Phase_3},
			</if>
			<if test="Voltage_Phase_1 != 0.001" >
				`Voltage_Phase_1` = #{Voltage_Phase_1},
			</if>
			<if test="Voltage_Phase_2 != 0.001" >
				`Voltage_Phase_2` = #{Voltage_Phase_2},
			</if>
			<if test="Voltage_Phase_3 != 0.001" >
				`Voltage_Phase_3` = #{Voltage_Phase_3},
			</if>
			<if test="Voltage_Phase_1_2 != 0.001" >
				`Voltage_Phase_1_2` = #{Voltage_Phase_1_2},
			</if>
			<if test="Voltage_Phase_2_3 != 0.001" >
				`Voltage_Phase_2_3` = #{Voltage_Phase_2_3},
			</if>
			<if test="Voltage_Phase_3_1 != 0.001" >
				`Voltage_Phase_3_1` = #{Voltage_Phase_3_1},
			</if>
			<if test="Residual_DC_Current != 0.001" >
				`Residual_DC_Current` = #{Residual_DC_Current},
			</if>
			<if test="Insulation_Resistance != 0.001" >
				`Insulation_Resistance` = #{Insulation_Resistance},
			</if>
			<if test="Feed_In_Time != 0.001" >
				`Feed_In_Time` = #{Feed_In_Time},
			</if>
			<if test="Operating_Time != 0.001" >
				`Operating_Time` = #{Operating_Time},
			</if>
			<if test="Total_Yield != 0.001" >
				`Total_Yield` = #{Total_Yield},
			</if>
			<if test="Internal_Temperature != 0.001" >
				`Internal_Temperature` = #{Internal_Temperature},
			</if>
			<if test="DC_Current_Input_1 != 0.001" >
				`DC_Current_Input_1` = #{DC_Current_Input_1},
			</if>
			<if test="DC_Current_Input_2 != 0.001" >
				`DC_Current_Input_2` = #{DC_Current_Input_2},
			</if>
			<if test="DC_Current_Input_3 != 0.001" >
				`DC_Current_Input_3` = #{DC_Current_Input_3},
			</if>
			<if test="DC_Current_Input_4 != 0.001" >
				`DC_Current_Input_4` = #{DC_Current_Input_4},
			</if>	
			<if test="DC_Voltage_Input_1 != 0.001" >
				`DC_Voltage_Input_1` = #{DC_Voltage_Input_1},
			</if>
			<if test="DC_Voltage_Input_2 != 0.001" >
				`DC_Voltage_Input_2` = #{DC_Voltage_Input_2},
			</if>
			<if test="DC_Voltage_Input_3 != 0.001" >
				`DC_Voltage_Input_3` = #{DC_Voltage_Input_3},
			</if>
			<if test="DC_Voltage_Input_4 != 0.001" >
				`DC_Voltage_Input_4` = #{DC_Voltage_Input_4},
			</if>
			<if test="DC_Power_Input_1 != 0.001" >
				`DC_Power_Input_1` = #{DC_Power_Input_1},
			</if>
			<if test="DC_Power_Input_2 != 0.001" >
				`DC_Power_Input_2` = #{DC_Power_Input_2},
			</if>
			<if test="DC_Power_Input_3 != 0.001" >
				`DC_Power_Input_3` = #{DC_Power_Input_3},
			</if>
			<if test="DC_Power_Input_4 != 0.001" >
				`DC_Power_Input_4` = #{DC_Power_Input_4},
			</if>		
			
			<if test="EventMessage != 0.001" >
				`EventMessage` = #{EventMessage},
			</if>	
			
			<if test="HealthCondition != 0.001" >
				`HealthCondition` = #{HealthCondition},
			</if>	
			
			<if test="FaultCorrectionMeasure != 0.001" >
				`FaultCorrectionMeasure` = #{FaultCorrectionMeasure},
			</if>	
			<if test="BlockStatus != 0.001" >
				`BlockStatus` = #{BlockStatus},
			</if>	
			<if test="ReasonforDerating != 0.001" >
				`ReasonforDerating` = #{ReasonforDerating},
			</if>
			
			<if test="nvmActivePower != 0.001" >
			 	`nvmActivePower` = #{nvmActivePower},
			</if>
			<if test="nvmActiveEnergy != 0.001" >
			 	`nvmActiveEnergy` = #{nvmActiveEnergy},
			</if>
			<if test="MeasuredProduction != 0.001 and MeasuredProduction > 0">
				`MeasuredProduction` = #{MeasuredProduction},
			</if>
		</trim>
	</insert>
	
	<select id="getLastRow" resultType="com.nwm.api.entities.ModelSmaStp2550us50Entity">
		SELECT
			dv.*,
			s.enable_alert
		FROM
			${view_tablename} dv 
			LEFT JOIN device d ON d.id = dv.id_device
			LEFT JOIN site s ON s.id = d.id_site
		WHERE
			dv.id_device = #{id_device}
			<if test="time != null" >
	        	AND dv.time <![CDATA[<]]> #{time}
	        </if>
		ORDER BY
			dv.time DESC 
			LIMIT 1
	</select>
	
	<select id="checkAlertWriteCode" resultType="Map">
    	SELECT
				m.EventMessage AS EventMessage,
				m.HealthCondition AS HealthCondition,
				m.FaultCorrectionMeasure AS FaultCorrectionMeasure,
				m.BlockStatus AS BlockStatus,
				m.ReasonforDerating AS ReasonforDerating
			FROM
				${datatablename} m
			WHERE
				id_device = #{id_device}
			ORDER BY
				time DESC 
			LIMIT 20;
  	</select>
  	
  	<select id="getListTriggerFaultCode" resultType="Map" parameterType="String">
		SELECT
			l.id,
			l.id_error,
			l.id_device,
			l.`status`,
			DATE_FORMAT(l.start_date,'%Y-%m-%d %H:%i:%s') AS start_date,
			DATE_FORMAT(NOW(),'%Y-%m-%d %H:%i:%s') AS end_date			
		FROM
			`alert` l
			LEFT JOIN error e ON e.id = l.id_error
			WHERE l.`status` = 1
			AND e.is_delete = 0 AND e.`status` = 1
			AND l.is_delete = 0 AND l.id_device = #{id_device}
			<if test="faultCodeLevel == 1">
				AND l.id_error IN(
				1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1840,1841,1842,1843,1844,1845,1846,1847,1848,1849,1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2331,2332,2333,2334,2335,2336
				)
			</if>
			
			<if test="faultCodeLevel == 2">
				AND l.id_error IN(
				2042,2043,2044,2045,2046,2047,2048,2049,2050,2051,2052,2053,2054,2055,2056
				)
			</if>
			
			<if test="faultCodeLevel == 3">
				AND l.id_error IN(
				2057,2058,2059,2060,2061,2062,2063,2064
				)
			</if>
			
			
	</select>
	
</mapper> 